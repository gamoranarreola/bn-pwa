
<ion-content>
  <ion-card>
    <ion-card-header class="ion-text-center">
      <ion-card-title>DETALLES DE PAGO</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div *ngIf="!loadingFlag" class="loaderContainer">
        <ion-spinner name="crescent"  color="#e4c683"></ion-spinner>
      </div>

      <ion-grid  *ngIf="loadingFlag">
        <ion-row class="ion-align-items-center">
          <ion-col size="4">
            <img src="../../../../../assets/images/shopping-cart/visa.svg" />
          </ion-col>
          <ion-col size="4">
            <img src="../../../../../assets/images/shopping-cart/mc.svg" />
          </ion-col>
          <ion-col size="4">
            <img src="../../../../../assets/images/shopping-cart/ae.svg" />
          </ion-col>
        </ion-row>
      </ion-grid>
      <form [formGroup]="ccForm" *ngIf="loadingFlag">
        <ion-grid>
          <ion-row>
            <ion-col size="8">
              <ion-input
                placeholder="N&uacute;mero de la Tarjeta"
                inputmode="numeric"
                formControlName="number"
                data-conekta="card[number]">
              </ion-input>
              <span
              class="error ion-padding"
              *ngIf="!ccForm.controls.number.untouched && ccForm.controls.number.hasError('required')"
              [innerHTML]="inputValidators.number.errorMessage">
            </span>
            </ion-col>
            <ion-col size="4">
              <ion-input
                placeholder="CVC"
                inputmode="numeric"
                formControlName="cvc"
                data-conekta="card[cvc]">
              </ion-input>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="12">
              <span>Fecha de Vencimiento</span>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="4">
              <ion-datetime
                presentation="month"
                placeholder="Mes"
                formControlName="exp_month"
                display-format="MM"
                data-conekta="card[exp_month]">
              </ion-datetime>
            </ion-col>
            <ion-col size="4">
              <ion-datetime
                placeholder="A&ntilde;o"
                presentation="year"
                formControlName="exp_year"
                display-format="YYYY"
                min="{{ getMinYear() }}"
                max="{{ getMaxYear() }}"
                data-conekta="card[exp_year]">
              </ion-datetime>
            </ion-col>

          </ion-row>
          <ion-row>
            <ion-col size="6">
              <ion-input
                placeholder="Nombre"
                formControlName="first_name"
                data-conekta="card[name]">
              </ion-input>
              <span
                class="error ion-padding"
                *ngIf="!ccForm.controls.first_name.untouched && ccForm.controls.first_name.hasError('pattern')"
                [innerHTML]="inputValidators.name.errorMessage">
              </span>
            </ion-col>
            <ion-col size="6">
              <ion-input
                placeholder="Apellido"
                formControlName="last_name">
              </ion-input>
              <span
                class="error ion-padding"
                *ngIf="!ccForm.controls.last_name.untouched && ccForm.controls.last_name.hasError('pattern')"
                [innerHTML]="inputValidators.name.errorMessage">
              </span>
            </ion-col>
          </ion-row>
          <!-- <ion-row>
            <ion-col size="12">
              <ion-input
                placeholder="Domicilio (calle y no., interior, etc.)"
                formControlName="street1">
              </ion-input>
            </ion-col>
          </ion-row> -->
          <!-- <ion-row>
            <ion-col size="12">
              <ion-input
                placeholder="Domicilio (colonia, fracc., etc.)"
                formControlName="street2">
              </ion-input>
            </ion-col>
          </ion-row> -->
          <!-- <ion-row>
            <ion-col size="6">
              <ion-input
                placeholder="Ciudad"
                formControlName="city">
              </ion-input>
            </ion-col>
            <ion-col size="6">
              <ion-select
                placeholder="Estado"
                interface="action-sheet"
                formControlName="state">
                <ion-select-option
                  *ngFor="let item of listService.getStates(ccForm?.get('country').value)"
                  value="{{ item.name }}">{{ item.name }}</ion-select-option>
              </ion-select>
            </ion-col>
          </ion-row> -->
          <!-- <ion-row>
            <ion-col size="6">
              <ion-input
                placeholder="C&oacute;digo Postal"
                formControlName="zip">
              </ion-input>
            </ion-col>
            <ion-col size="6">
              <ion-select
                placeholder="Pa&iacute;s"
                interface="action-sheet"
                formControlName="country">
                <ion-select-option
                  *ngFor="let item of listService.getCountries()"
                  value="{{ item.code }}">{{ item.name }}</ion-select-option>
              </ion-select>
            </ion-col>
          </ion-row> -->
          <ion-row>
            <ion-col size="12">
              <ion-input
                placeholder="Correo Electr&oacute;nico"
                formControlName="email"
                type="email">
              </ion-input>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col size="12">
              <ion-intl-tel-input
                inputPlaceholder="Tel&eacute;fono"
                [onlyCountries]="['mx', 'us']"
                [modalTitle]="'Selecciona tu Pa&iacute;s'"
                [modalSearchPlaceholder]="'Ingresa el nombre de tu pa&iacute;s'"
                [modalCloseText]="'Cerrar'"
                formControlName="phone"
              ></ion-intl-tel-input>
            </ion-col>
          </ion-row>
        </ion-grid>
      </form>
      <!-- [disabled]="!(ccForm.touched && ccForm.valid)"  -->
      <ion-button
        expand="block"
        (click)="submitPayment()"
        [disabled]="!(ccForm.touched && ccForm.valid)"
        *ngIf="loadingFlag ">Emitir Pago</ion-button>
        <div *ngIf="!loadingFlag "><strong>Estamos procesando su pago.</strong></div>
    </ion-card-content>
  </ion-card>
</ion-content>
